(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ff034b0c"],{"0c4d":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"upload-container"},[s("div",{staticClass:"btn"},[s("el-button",{staticClass:"btnSetting",attrs:{type:"info",icon:"el-icon-setting",circle:""},on:{click:function(t){e.drawer=!0}}}),s("el-button",{staticClass:"btnUpload",attrs:{type:"primary"},on:{click:e.dataStorage}},[e._v("批量入库"),s("i",{staticClass:"el-icon-upload el-icon--right"})]),s("el-button",{staticClass:"btnUpload",attrs:{type:"primary"},on:{click:e.clearData}},[e._v("清空数据"),s("i",{staticClass:"el-icon-upload el-icon--right"})])],1),s("div",{staticClass:"upload"},[s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"auto-upload":!1,"on-remove":e.handleRemove,drag:"",action:"",multiple:"","file-list":e.fileList,"on-change":e.handleChange}},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),s("em",[e._v("点击上传")])])])],1),s("el-drawer",{attrs:{title:"数据库连接配置",visible:e.drawer,"before-close":e.handleClose},on:{"update:visible":function(t){e.drawer=t}}},[s("div",{staticStyle:{width:"95%"},attrs:{id:"demo-drawer__content"}},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"ip地址",prop:"ip"}},[s("el-input",{model:{value:e.ruleForm.ip,callback:function(t){e.$set(e.ruleForm,"ip",t)},expression:"ruleForm.ip"}})],1),s("el-form-item",{attrs:{label:"port端口号",prop:"port"}},[s("el-input",{model:{value:e.ruleForm.port,callback:function(t){e.$set(e.ruleForm,"port",t)},expression:"ruleForm.port"}})],1),s("el-form-item",{attrs:{label:"数据库名称",prop:"database"}},[s("el-input",{model:{value:e.ruleForm.database,callback:function(t){e.$set(e.ruleForm,"database",t)},expression:"ruleForm.database"}})],1),s("el-form-item",{attrs:{label:"scheme",prop:"scheme"}},[s("el-input",{model:{value:e.ruleForm.scheme,callback:function(t){e.$set(e.ruleForm,"scheme",t)},expression:"ruleForm.scheme"}})],1),s("el-form-item",{attrs:{label:"用户名称",prop:"username"}},[s("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),s("el-form-item",[s("el-button",{attrs:{id:"btn",type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("保存")])],1)],1)],1)])],1)},a=[],i=(s("14d9"),s("bc3a")),o=s.n(i),l={name:"",data(){return{fileList:[],drawer:!1,tableData:[],tb:[],input:"",ruleForm:{ip:this.$cookies.get("ip"),port:this.$cookies.get("port"),database:this.$cookies.get("database"),scheme:this.$cookies.get("scheme"),username:this.$cookies.get("username"),password:this.$cookies.get("password")},rules:{ip:[{required:!0,message:"ip地址不能为空！",trigger:"blur"}],port:[{required:!0,message:"端口号不能为空！",trigger:"blur"}],database:[{required:!0,message:"数据库名称不能为空！",trigger:"blur"}],scheme:[{required:!0,message:"scheme不能为空！",trigger:"blur"}],username:[{required:!0,message:"用户名称不能为空！",trigger:"blur"}],password:[{required:!0,message:"密码不能为空！",trigger:"blur"}]}}},methods:{deleteRow(e,t){t.splice(e,1)},handleClose(){this.drawer=!1},handleChange(e,t){this.fileList=t},handleRemove(e,t){this.fileList=t},clearData(){this.fileList=[]},selectFlie(){o.a.post("data/filesPath",this.input,{headers:{"Content-Type":"text/plain"}}).then(e=>{this.tableData=[],this.tb=[],e.data.forEach(e=>{"shp"==e.split(".")[1]&&2==e.split(".").length&&(this.tableData.push({path:e}),this.tb.push(e))})}).catch(e=>{console.log(e)})},dataStorage(){if(null==this.ruleForm.ip)return void this.$message("请设置数据库连接!");const e=new FormData;this.$confirm("加入任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message({type:"success",message:"加入成功!"},this.fileList.forEach(t=>{e.append("files",t.raw)}),this.tb=[],this.fileList.forEach(e=>{this.tb.push(e.name)}),this.MultipartFile(e),o.a.post("data/store",{tb:this.tb,db:this.ruleForm},{headers:{"Content-Type":"application/json"}}).then(e=>{this.$message({message:"批量入库成功",type:"success"})}).catch(e=>{}))}).catch(()=>{this.$message({type:"info",message:"已取消"})})},MultipartFile(e,t){o.a.post("http://192.168.16.192:8086/file/upload2server",e,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{200==e.status&&this.$message({message:"文件上传成功",type:"success"})}).catch(e=>{console.log("文件上传失败："+e)})},submitForm(e){this.$refs[e].validate(e=>{if(!e)return console.log("error submit!!"),!1;this.$cookies.remove("ip"),this.$cookies.remove("port"),this.$cookies.remove("database"),this.$cookies.remove("scheme"),this.$cookies.remove("username"),this.$cookies.remove("password"),this.$cookies.set("ip",this.ruleForm.ip,"0"),this.$cookies.set("port",this.ruleForm.port,"0"),this.$cookies.set("database",this.ruleForm.database,"0"),this.$cookies.set("scheme",this.ruleForm.scheme,"0"),this.$cookies.set("username",this.ruleForm.username,"0"),this.$cookies.set("password",this.ruleForm.password,"0"),this.$message("保存成功!")})}}},n=l,c=(s("eff4"),s("2877")),u=Object(c["a"])(n,r,a,!1,null,"66b9035b",null);t["default"]=u.exports},7516:function(e,t,s){},eff4:function(e,t,s){"use strict";s("7516")}}]);