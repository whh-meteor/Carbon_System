(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12a364a2"],{"0899":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"upload-container"},[s("div",{staticClass:"btn"},[s("el-input",{staticClass:"input1",attrs:{placeholder:"请输入SHP数据存放文件夹路径"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[s("template",{slot:"prepend"},[e._v("路径")])],2),s("el-button",{staticClass:"btnSelect",attrs:{type:"primary"},on:{click:e.selectFlie}},[e._v("解析文件"),s("i",{staticClass:"el-icon-folder-add el-icon--right"})]),s("el-button",{staticClass:"btnSetting",attrs:{type:"info",icon:"el-icon-setting",circle:""},on:{click:function(t){e.drawer=!0}}}),s("el-button",{staticClass:"btnUpload",attrs:{type:"primary"},on:{click:e.dataStorage}},[e._v("批量入库"),s("i",{staticClass:"el-icon-upload el-icon--right"})])],1),s("div",{staticClass:"table"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"max-height":"500"}},[s("el-table-column",{attrs:{type:"index",width:"50"}}),s("el-table-column",{attrs:{prop:"path",label:"文件地址",width:"1000"}}),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(s){return s.preventDefault(),e.deleteRow(t.$index,e.tableData)}}},[e._v(" 移除 ")])]}}])})],1)],1),s("el-drawer",{attrs:{title:"数据库连接配置",visible:e.drawer,"before-close":e.handleClose},on:{"update:visible":function(t){e.drawer=t}}},[s("div",{staticStyle:{width:"95%"},attrs:{id:"demo-drawer__content"}},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"ip地址",prop:"ip"}},[s("el-input",{model:{value:e.ruleForm.ip,callback:function(t){e.$set(e.ruleForm,"ip",t)},expression:"ruleForm.ip"}})],1),s("el-form-item",{attrs:{label:"port端口号",prop:"port"}},[s("el-input",{model:{value:e.ruleForm.port,callback:function(t){e.$set(e.ruleForm,"port",t)},expression:"ruleForm.port"}})],1),s("el-form-item",{attrs:{label:"数据库名称",prop:"database"}},[s("el-input",{model:{value:e.ruleForm.database,callback:function(t){e.$set(e.ruleForm,"database",t)},expression:"ruleForm.database"}})],1),s("el-form-item",{attrs:{label:"scheme",prop:"scheme"}},[s("el-input",{model:{value:e.ruleForm.scheme,callback:function(t){e.$set(e.ruleForm,"scheme",t)},expression:"ruleForm.scheme"}})],1),s("el-form-item",{attrs:{label:"用户名称",prop:"username"}},[s("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),s("el-form-item",[s("el-button",{attrs:{id:"btn",type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("保存")])],1)],1)],1)])],1)},a=[],o=(s("14d9"),s("bc3a")),i=s.n(o),l={name:"",data(){return{drawer:!1,tableData:[],tb:[],input:"",ruleForm:{ip:this.$cookies.get("ip"),port:this.$cookies.get("port"),database:this.$cookies.get("database"),scheme:this.$cookies.get("scheme"),username:this.$cookies.get("username"),password:this.$cookies.get("password")},rules:{ip:[{required:!0,message:"ip地址不能为空！",trigger:"blur"}],port:[{required:!0,message:"端口号不能为空！",trigger:"blur"}],database:[{required:!0,message:"数据库名称不能为空！",trigger:"blur"}],scheme:[{required:!0,message:"scheme不能为空！",trigger:"blur"}],username:[{required:!0,message:"用户名称不能为空！",trigger:"blur"}],password:[{required:!0,message:"密码不能为空！",trigger:"blur"}]}}},methods:{deleteRow(e,t){t.splice(e,1)},handleClose(){this.drawer=!1},selectFlie(){i.a.post("data/filesPath",this.input,{headers:{"Content-Type":"text/plain"}}).then(e=>{this.tableData=[],this.tb=[],e.data.forEach(e=>{"shp"==e.split(".")[1]&&2==e.split(".").length&&(console.log(e.split(".")[1]),this.tableData.push({path:e}),this.tb.push(e))})}).catch(e=>{console.log(e)})},dataStorage(){0!=this.tableData.length?null!=this.ruleForm.ip?this.$confirm("加入任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message({type:"success",message:"加入成功!"},i.a.post("data/store",{tb:this.tb,db:this.ruleForm},{headers:{"Content-Type":"application/json"}}).then(e=>{}).catch(e=>{}))}).catch(()=>{this.$message({type:"info",message:"已取消"})}):this.$message("请设置数据库连接!"):this.$message("请输入数据!")},submitForm(e){this.$refs[e].validate(e=>{if(!e)return console.log("error submit!!"),!1;this.$cookies.remove("ip"),this.$cookies.remove("port"),this.$cookies.remove("database"),this.$cookies.remove("scheme"),this.$cookies.remove("username"),this.$cookies.remove("password"),this.$cookies.set("ip",this.ruleForm.ip,"0"),this.$cookies.set("port",this.ruleForm.port,"0"),this.$cookies.set("database",this.ruleForm.database,"0"),this.$cookies.set("scheme",this.ruleForm.scheme,"0"),this.$cookies.set("username",this.ruleForm.username,"0"),this.$cookies.set("password",this.ruleForm.password,"0"),this.$message("保存成功!")})}}},n=l,c=(s("cdf5"),s("2877")),u=Object(c["a"])(n,r,a,!1,null,"2df6618a",null);t["default"]=u.exports},5993:function(e,t,s){},cdf5:function(e,t,s){"use strict";s("5993")}}]);